# ë°ì´í„° ìˆ˜ì§‘ ë‹¨ê³„ ê°„ì†Œí™”

## ê°œìš”

### ë¬¸ì œ ìš”ì•½
í˜„ì¬ ì´ë¯¸ì§€ ìº¡ì²˜ íë¦„ì´ 5ë‹¨ê³„ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, íŠ¹íˆ í™•ì¸ íŒì—…ì—ì„œ íšŒì‚¬ ì •ë³´ë¥¼ ì¤‘ë³µ ì…ë ¥í•´ì•¼ í•˜ê³ , ì—°ì† ìº¡ì²˜ê°€ ë¶ˆê°€ëŠ¥í•˜ì—¬ ì—¬ëŸ¬ ì´ë¯¸ì§€ë¥¼ ìˆ˜ì§‘í•  ë•Œ ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤.

### ê°œì„  ëª©í‘œ
1. í™•ì¸ íŒì—… ìŠ¤í‚µ ì˜µì…˜ ì œê³µ (íŒì—…ì—ì„œ ì„ íƒí•œ íšŒì‚¬ë¡œ ë°”ë¡œ ì €ì¥)
2. ì—°ì† ìº¡ì²˜ ëª¨ë“œ ì¶”ê°€ (ê°™ì€ íšŒì‚¬ì— ì—¬ëŸ¬ ì´ë¯¸ì§€ ë¹ ë¥´ê²Œ ì €ì¥)
3. ìº¡ì²˜ ì™„ë£Œ ì‹œ íŒì—… ìœ ì§€ ì˜µì…˜

---

## AS-IS (í˜„ì¬ ìƒíƒœ)

### í˜„ì¬ íë¦„

```
[1ë‹¨ê³„] ìµìŠ¤í…ì…˜ íŒì—… í´ë¦­
    â†“
[2ë‹¨ê³„] íšŒì‚¬ëª… ì…ë ¥/ì„ íƒ + "í™”ë©´ ìº¡ì²˜" ë²„íŠ¼ í´ë¦­
    â†“ (íŒì—… 500ms í›„ ìë™ ë‹«í˜)
[3ë‹¨ê³„] í˜ì´ì§€ì—ì„œ ì˜ì—­ ë“œë˜ê·¸ ì„ íƒ
    â†“
[4ë‹¨ê³„] í™•ì¸ íŒì—… í‘œì‹œ - ì €ì¥ ëŒ€ìƒ(ìƒˆ íšŒì‚¬/ê¸°ì¡´ íšŒì‚¬) ë‹¤ì‹œ ì„ íƒ
    â†“
[5ë‹¨ê³„] "ì €ì¥" ë²„íŠ¼ í´ë¦­
```

### ë¬¸ì œì 

1. **íšŒì‚¬ ì •ë³´ ì¤‘ë³µ ì…ë ¥**
   - íŒì—…ì—ì„œ ì´ë¯¸ íšŒì‚¬ëª…ì„ ì…ë ¥í–ˆëŠ”ë°, í™•ì¸ íŒì—…ì—ì„œ ë‹¤ì‹œ ì„ íƒí•´ì•¼ í•¨
   - íŠ¹íˆ "ê¸°ì¡´ íšŒì‚¬ì— ì¶”ê°€" ì„ íƒ ì‹œ ë“œë¡­ë‹¤ìš´ì—ì„œ ë‹¤ì‹œ ì°¾ì•„ì•¼ í•¨

2. **ì—°ì† ìº¡ì²˜ ë¶ˆê°€**
   - ìº¡ì²˜ ë²„íŠ¼ í´ë¦­ ì‹œ íŒì—…ì´ ìë™ìœ¼ë¡œ ë‹«í˜
   - ê°™ì€ íšŒì‚¬ì— ì—¬ëŸ¬ ì´ë¯¸ì§€ ì €ì¥ ì‹œ ë§¤ë²ˆ íŒì—…ì„ ë‹¤ì‹œ ì—´ì–´ì•¼ í•¨
   - í•œ í˜ì´ì§€ì—ì„œ 5ê°œ ì´ë¯¸ì§€ ìº¡ì²˜ ì‹œ íŒì—…ì„ 5ë²ˆ ì—´ì–´ì•¼ í•¨

3. **ë¶ˆí•„ìš”í•œ í™•ì¸ ë‹¨ê³„**
   - ëª¨ë“  ìº¡ì²˜ë§ˆë‹¤ í™•ì¸ íŒì—…ì´ í‘œì‹œë¨
   - ë¹ ë¥¸ ìº¡ì²˜ê°€ í•„ìš”í•œ ê²½ìš°ì—ë„ í•­ìƒ í™•ì¸ í•„ìš”

### ê´€ë ¨ ì½”ë“œ

#### íŒì—… ìë™ ë‹«í˜ ë¡œì§
**íŒŒì¼**: `extension/src/popup/MiniPopup.tsx:31-36`
```typescript
const onCapture = async () => {
  const success = await handleCapture();
  if (success) {
    setTimeout(() => window.close(), 500);  // â† 500ms í›„ íŒì—… ë‹«í˜
  }
};
```

#### TRIGGER_CAPTURE ë©”ì‹œì§€ ì „ì†¡
**íŒŒì¼**: `extension/src/popup/hooks/usePopupState.ts:145-148`
```typescript
await chrome.tabs.sendMessage(tab.id, {
  type: 'TRIGGER_CAPTURE',
  payload: { companyName: finalCompanyName },  // â† íšŒì‚¬ëª…ë§Œ ì „ë‹¬
});
```

#### í™•ì¸ íŒì—…ì—ì„œ ë‹¤ì‹œ íšŒì‚¬ ì„ íƒ
**íŒŒì¼**: `extension/src/content/confirm-popup.tsx:81-143`
```typescript
// ì €ì¥ ëŒ€ìƒ ì„ íƒ (Radio ë²„íŠ¼)
<div className="aca-radio-group">
  <label>
    <input type="radio" name="saveTarget" value="new" ... />
    ìƒˆ íšŒì‚¬ ìƒì„±
  </label>
  <label>
    <input type="radio" name="saveTarget" value="existing" ... />
    ê¸°ì¡´ íšŒì‚¬ì— ì¶”ê°€
  </label>
</div>

// ìƒˆ íšŒì‚¬ì¸ ê²½ìš°: íšŒì‚¬ëª… ë‹¤ì‹œ ì…ë ¥
// ê¸°ì¡´ íšŒì‚¬ì¸ ê²½ìš°: ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒ
```

#### ì˜ì—­ ì„ íƒ ì™„ë£Œ í›„ í™•ì¸ íŒì—… í‘œì‹œ
**íŒŒì¼**: `extension/src/content/index.ts:23-29`
```typescript
const result = await showConfirmPopup({
  imageDataUrl,
  detectedCompanyName: scrapedData.companyName,
  companyUrl: scrapedData.url,
  siteType: scrapedData.siteType,
  siteName: site.name,
});
```

---

## TO-BE (ê°œì„  í›„)

### ê°œì„ ëœ íë¦„

#### ì˜µì…˜ 1: ë¹ ë¥¸ ìº¡ì²˜ ëª¨ë“œ (í™•ì¸ íŒì—… ìŠ¤í‚µ)
```
[1ë‹¨ê³„] ìµìŠ¤í…ì…˜ íŒì—… - íšŒì‚¬ ì„ íƒ + "ë¹ ë¥¸ ìº¡ì²˜" í† ê¸€ ON
    â†“
[2ë‹¨ê³„] "í™”ë©´ ìº¡ì²˜" ë²„íŠ¼ í´ë¦­
    â†“
[3ë‹¨ê³„] ì˜ì—­ ë“œë˜ê·¸ â†’ ìë™ ì €ì¥ (í™•ì¸ íŒì—… ì—†ìŒ)
    â†“
[4ë‹¨ê³„] í˜ì´ì§€ì— "ì €ì¥ ì™„ë£Œ" í† ìŠ¤íŠ¸ í‘œì‹œ (1.5ì´ˆ)
```

#### ì˜µì…˜ 2: ì—°ì† ìº¡ì²˜ ëª¨ë“œ
```
[1ë‹¨ê³„] ìµìŠ¤í…ì…˜ íŒì—… - íšŒì‚¬ ì„ íƒ + "ì—°ì† ìº¡ì²˜" í† ê¸€ ON
    â†“
[2ë‹¨ê³„] "í™”ë©´ ìº¡ì²˜" ë²„íŠ¼ í´ë¦­ (íŒì—… ë‹«íˆì§€ ì•ŠìŒ)
    â†“
[3ë‹¨ê³„] ì˜ì—­ ë“œë˜ê·¸ â†’ ì €ì¥ â†’ ìº¡ì²˜ ëª¨ë“œ ìœ ì§€
    â†“
[4ë‹¨ê³„] ESC ë˜ëŠ” íŒì—…ì—ì„œ "ì™„ë£Œ" í´ë¦­ ì‹œ ì¢…ë£Œ
```

### êµ¬í˜„ ìƒì„¸

#### 1. ìº¡ì²˜ ì„¤ì • ì €ì¥ êµ¬ì¡°
```typescript
// extension/src/lib/storage.ts
interface CaptureSettings {
  quickCaptureEnabled: boolean;    // ë¹ ë¥¸ ìº¡ì²˜ ëª¨ë“œ (í™•ì¸ íŒì—… ìŠ¤í‚µ)
  continuousCaptureEnabled: boolean;  // ì—°ì† ìº¡ì²˜ ëª¨ë“œ
  lastSelectedCompanyId?: string;  // ë§ˆì§€ë§‰ ì„ íƒ íšŒì‚¬ (ì—°ì† ìº¡ì²˜ìš©)
}

// Chrome Storage Syncì— ì €ì¥
async function saveCaptureSettings(settings: CaptureSettings): Promise<void>;
async function loadCaptureSettings(): Promise<CaptureSettings>;
```

#### 2. TRIGGER_CAPTURE ë©”ì‹œì§€ í™•ì¥
```typescript
// í˜„ì¬
{ type: 'TRIGGER_CAPTURE', payload: { companyName: string } }

// ê°œì„  í›„
{
  type: 'TRIGGER_CAPTURE',
  payload: {
    companyName: string;
    companyId?: string;          // ê¸°ì¡´ íšŒì‚¬ ID (ìˆìœ¼ë©´ í•´ë‹¹ íšŒì‚¬ì— ì¶”ê°€)
    quickCapture: boolean;        // í™•ì¸ íŒì—… ìŠ¤í‚µ ì—¬ë¶€
    continuousCapture: boolean;   // ì—°ì† ìº¡ì²˜ ëª¨ë“œ ì—¬ë¶€
  }
}
```

#### 3. ë¹ ë¥¸ ìº¡ì²˜ ì‹œ í™•ì¸ íŒì—… ìŠ¤í‚µ
```typescript
// extension/src/content/index.ts
async function handleRegionCapture(imageDataUrl: string): Promise<void> {
  const captureContext = getCaptureContext();  // ë©”ì‹œì§€ì—ì„œ ë°›ì€ ì„¤ì •

  if (captureContext.quickCapture && captureContext.companyId) {
    // í™•ì¸ íŒì—… ì—†ì´ ë°”ë¡œ ì €ì¥
    await saveImageDirectly({
      dataUrl: imageDataUrl,
      companyId: captureContext.companyId,
      siteType: scrapedData.siteType,
    });
    showToast('ì €ì¥ ì™„ë£Œ');
    return;
  }

  // ê¸°ì¡´ í™•ì¸ íŒì—… íë¦„
  const result = await showConfirmPopup({ ... });
}
```

#### 4. ì—°ì† ìº¡ì²˜ ëª¨ë“œ
```typescript
// extension/src/popup/MiniPopup.tsx
const onCapture = async () => {
  const success = await handleCapture();
  if (success) {
    if (continuousCaptureEnabled) {
      // íŒì—… ìœ ì§€, ìº¡ì²˜ ì™„ë£Œ í‘œì‹œë§Œ
      setCaptureStatus('completed');
      setTimeout(() => setCaptureStatus('ready'), 1500);
    } else {
      setTimeout(() => window.close(), 500);
    }
  }
};
```

#### 5. ì €ì¥ ì™„ë£Œ í† ìŠ¤íŠ¸ UI
```typescript
// extension/src/content/toast.tsx
function showCaptureToast(message: string, duration: number = 1500): void {
  // Shadow DOMìœ¼ë¡œ ê²©ë¦¬ëœ í† ìŠ¤íŠ¸ í‘œì‹œ
  // ìœ„ì¹˜: í™”ë©´ ìš°ìƒë‹¨
  // ìŠ¤íƒ€ì¼: 2px ê²€ì • í…Œë‘ë¦¬, í° ë°°ê²½ (ê¸°ì¡´ UI í†¤ ìœ ì§€)
}
```

### UI/UX ë³€ê²½ì‚¬í•­

#### íŒì—… UI ë³€ê²½
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI Company Analyzer       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Source: âœ“ Wanted            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Company                     â”‚
â”‚ [íšŒì‚¬ëª… ì…ë ¥]    â†“          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€ Capture Options â”€â”€â”€â”€â”€â”€â”€â” â”‚  â† ìƒˆë¡œ ì¶”ê°€
â”‚ â”‚ â–¡ ë¹ ë¥¸ ìº¡ì²˜ (í™•ì¸ ìƒëµ) â”‚ â”‚
â”‚ â”‚ â–¡ ì—°ì† ìº¡ì²˜ ëª¨ë“œ        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [    í™”ë©´ ìº¡ì²˜  â†’    ]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5 companies Â· 128 KB        â”‚
â”‚ Open Dashboard â†’            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ì—°ì† ìº¡ì²˜ ëª¨ë“œ í™œì„±í™” ì‹œ íŒì—… UI
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI Company Analyzer       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”„ ì—°ì† ìº¡ì²˜ ëª¨ë“œ           â”‚  â† ìƒíƒœ í‘œì‹œ
â”‚ ëŒ€ìƒ: Naver                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ìº¡ì²˜: 3ì¥ ì™„ë£Œ              â”‚  â† ì¹´ìš´í„°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [  ë‹¤ìŒ ìº¡ì²˜  â†’  ]          â”‚
â”‚ [     ì™„ë£Œ      ]           â”‚  â† ì¢…ë£Œ ë²„íŠ¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ìˆ˜ì • ëŒ€ìƒ íŒŒì¼

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ë‚´ìš© |
|-----------|----------|
| `extension/src/popup/MiniPopup.tsx` | ìº¡ì²˜ ì˜µì…˜ í† ê¸€ UI ì¶”ê°€, ì—°ì† ìº¡ì²˜ ì‹œ íŒì—… ìœ ì§€ |
| `extension/src/popup/hooks/usePopupState.ts` | ìº¡ì²˜ ì„¤ì • ìƒíƒœ ê´€ë¦¬, TRIGGER_CAPTURE í˜ì´ë¡œë“œ í™•ì¥ |
| `extension/src/content/index.ts` | ìº¡ì²˜ ì»¨í…ìŠ¤íŠ¸ ì €ì¥, ë¹ ë¥¸ ìº¡ì²˜ ë¶„ê¸° ì²˜ë¦¬ |
| `extension/src/content/confirm-popup.tsx` | quickCapture ì‹œ ìŠ¤í‚µ ë¡œì§ |
| `extension/src/content/toast.tsx` | (ì‹ ê·œ) ì €ì¥ ì™„ë£Œ í† ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ |
| `extension/src/content/area-capture.ts` | ì—°ì† ìº¡ì²˜ ì‹œ ëª¨ë“œ ìœ ì§€ |
| `extension/src/lib/storage.ts` | CaptureSettings íƒ€ì… ë° ì €ì¥ í•¨ìˆ˜ ì¶”ê°€ |
| `shared/types/messages.ts` | TRIGGER_CAPTURE í˜ì´ë¡œë“œ íƒ€ì… í™•ì¥ |

---

## êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1: ì„¤ì • ì €ì¥ ê¸°ë°˜
- [ ] `CaptureSettings` íƒ€ì… ì •ì˜ (`extension/src/lib/storage.ts`)
- [ ] Chrome Storageì— ì„¤ì • ì €ì¥/ë¡œë“œ í•¨ìˆ˜ êµ¬í˜„
- [ ] `TRIGGER_CAPTURE` ë©”ì‹œì§€ í˜ì´ë¡œë“œ íƒ€ì… í™•ì¥

### Phase 2: ë¹ ë¥¸ ìº¡ì²˜ ëª¨ë“œ
- [ ] íŒì—…ì— "ë¹ ë¥¸ ìº¡ì²˜" í† ê¸€ UI ì¶”ê°€
- [ ] Content Scriptì—ì„œ quickCapture ë¶„ê¸° ì²˜ë¦¬
- [ ] í™•ì¸ íŒì—… ìŠ¤í‚µ í›„ ë°”ë¡œ ì €ì¥ ë¡œì§
- [ ] ì €ì¥ ì™„ë£Œ í† ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

### Phase 3: ì—°ì† ìº¡ì²˜ ëª¨ë“œ
- [ ] íŒì—…ì— "ì—°ì† ìº¡ì²˜" í† ê¸€ UI ì¶”ê°€
- [ ] ìº¡ì²˜ ì„±ê³µ ì‹œ íŒì—… ìœ ì§€ ë¡œì§
- [ ] ìº¡ì²˜ ì¹´ìš´í„° í‘œì‹œ
- [ ] "ì™„ë£Œ" ë²„íŠ¼ìœ¼ë¡œ ëª¨ë“œ ì¢…ë£Œ
- [ ] ESC í‚¤ë¡œ ëª¨ë“œ ì¢…ë£Œ

### Phase 4: í…ŒìŠ¤íŠ¸
- [ ] ë¹ ë¥¸ ìº¡ì²˜: ìƒˆ íšŒì‚¬ + ê¸°ì¡´ íšŒì‚¬ ëª¨ë‘ í…ŒìŠ¤íŠ¸
- [ ] ì—°ì† ìº¡ì²˜: 5ì¥ ì´ìƒ ì—°ì† ìº¡ì²˜ í…ŒìŠ¤íŠ¸
- [ ] ì„¤ì • ì €ì¥: ë¸Œë¼ìš°ì € ì¬ì‹œì‘ í›„ ì„¤ì • ìœ ì§€ í™•ì¸
- [ ] ì—ëŸ¬ ì¼€ì´ìŠ¤: ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ í† ìŠ¤íŠ¸ í‘œì‹œ

---

## ì°¸ê³ ì‚¬í•­

### ì œì™¸ëœ ê¸°ëŠ¥
- **í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤**: ì‚¬ì´íŠ¸ë³„ ë‹¨ì¶•í‚¤ ì¶©ëŒ ìš°ë ¤ë¡œ ì œì™¸

### í˜¸í™˜ì„±
- ê¸°ì¡´ í™•ì¸ íŒì—… íë¦„ì€ ê¸°ë³¸ê°’ìœ¼ë¡œ ìœ ì§€ (ì˜µì…˜ OFF ì‹œ)
- ì„¤ì •ì€ Chrome Storage Syncì— ì €ì¥í•˜ì—¬ ê¸°ê¸° ê°„ ë™ê¸°í™”
