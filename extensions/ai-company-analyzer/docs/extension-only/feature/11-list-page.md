# 11. íšŒì‚¬ ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€

## ê°œìš”
ì €ì¥ëœ íšŒì‚¬ ëª©ë¡ í˜ì´ì§€ êµ¬í˜„

## ì„ í–‰ ì¡°ê±´
- 02-data-storage ì™„ë£Œ
- 09-webllm-text-analysis ì™„ë£Œ

## ê¸°ìˆ  ìŠ¤íƒ
| ë¶„ë¥˜ | ê¸°ìˆ  |
|------|------|
| UI | React + TypeScript |
| ë°ì´í„° ì¡°íšŒ | dexie-react-hooks |

---

## í™”ë©´ êµ¬ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI ê¸°ì—…ë¶„ì„ - íšŒì‚¬ ëª©ë¡                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ” ê²€ìƒ‰...]           ì •ë ¬: [ìµœê·¼ìˆœ â–¼]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ì‚¼ì„±ì „ì                              â­ 4.2    â”‚ â”‚
â”‚ â”‚ [ì›í‹°ë“œ] [í˜ì‹ ì˜ìˆ²] [DART]                      â”‚ â”‚
â”‚ â”‚ ìˆ˜ì§‘ì¼: 2024-01-15                      [ğŸ—‘ï¸]   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ë„¤ì´ë²„                                ë¶„ì„ ì „   â”‚ â”‚
â”‚ â”‚ [ì›í‹°ë“œ] [ë¸”ë¼ì¸ë“œ]                             â”‚ â”‚
â”‚ â”‚ ìˆ˜ì§‘ì¼: 2024-01-14                      [ğŸ—‘ï¸]   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ ...                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## êµ¬í˜„

### src/pages/list/ListPage.tsx

```typescript
import React, { useState, useMemo } from 'react';
import { createRoot } from 'react-dom/client';
import { useLiveQuery } from 'dexie-react-hooks';
import { db } from '@/lib/db';
import { deleteCompany } from '@/lib/storage';
import type { Company } from '@/types/storage';
import './list.css';

type SortOption = 'recent' | 'name' | 'score';

function ListPage() {
  const [searchQuery, setSearchQuery] = useState('');
  const [sortBy, setSortBy] = useState<SortOption>('recent');

  // íšŒì‚¬ ëª©ë¡ ì‹¤ì‹œê°„ ì¡°íšŒ
  const companies = useLiveQuery(() => db.companies.toArray(), [], []);

  // ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
  const analysisResults = useLiveQuery(
    () => db.analysisResults.toArray(),
    [],
    []
  );

  // ì¶”ì¶œ ë°ì´í„° ì¡°íšŒ (ì†ŒìŠ¤ ë°°ì§€ìš©)
  const extractedData = useLiveQuery(
    () => db.extractedData.toArray(),
    [],
    []
  );

  // íšŒì‚¬ë³„ ë°ì´í„° ë§¤í•‘
  const companyDataMap = useMemo(() => {
    const map = new Map<string, { score?: number; sources: string[] }>();

    companies.forEach((company) => {
      const analysis = analysisResults.find((a) => a.companyId === company.id);
      const data = extractedData.filter((d) => d.companyId === company.id);
      const sources = [...new Set(data.map((d) => getSourceLabel(d.type)))];

      map.set(company.id, {
        score: analysis?.totalScore,
        sources,
      });
    });

    return map;
  }, [companies, analysisResults, extractedData]);

  // í•„í„°ë§ ë° ì •ë ¬
  const filteredCompanies = useMemo(() => {
    let result = [...companies];

    // ê²€ìƒ‰ í•„í„°
    if (searchQuery) {
      const query = searchQuery.toLowerCase();
      result = result.filter((c) => c.name.toLowerCase().includes(query));
    }

    // ì •ë ¬
    switch (sortBy) {
      case 'recent':
        result.sort((a, b) => b.updatedAt - a.updatedAt);
        break;
      case 'name':
        result.sort((a, b) => a.name.localeCompare(b.name));
        break;
      case 'score':
        result.sort((a, b) => {
          const scoreA = companyDataMap.get(a.id)?.score || 0;
          const scoreB = companyDataMap.get(b.id)?.score || 0;
          return scoreB - scoreA;
        });
        break;
    }

    return result;
  }, [companies, searchQuery, sortBy, companyDataMap]);

  // ì‚­ì œ í•¸ë“¤ëŸ¬
  const handleDelete = async (company: Company) => {
    if (confirm(`"${company.name}" íšŒì‚¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
      await deleteCompany(company.id);
    }
  };

  // ìƒì„¸ í˜ì´ì§€ ì´ë™
  const handleOpenDetail = (companyId: string) => {
    chrome.tabs.create({
      url: chrome.runtime.getURL(`pages/detail/detail.html?id=${companyId}`),
    });
  };

  return (
    <div className="list-page">
      <header className="page-header">
        <h1>AI ê¸°ì—…ë¶„ì„</h1>
        <p className="subtitle">ì €ì¥ëœ íšŒì‚¬ ëª©ë¡</p>
      </header>

      <div className="controls">
        <div className="search-box">
          <input
            type="text"
            placeholder="íšŒì‚¬ëª… ê²€ìƒ‰..."
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
          />
        </div>

        <div className="sort-box">
          <label>ì •ë ¬:</label>
          <select
            value={sortBy}
            onChange={(e) => setSortBy(e.target.value as SortOption)}
          >
            <option value="recent">ìµœê·¼ìˆœ</option>
            <option value="name">ì´ë¦„ìˆœ</option>
            <option value="score">ì ìˆ˜ìˆœ</option>
          </select>
        </div>
      </div>

      <div className="company-list">
        {filteredCompanies.length === 0 ? (
          <div className="empty-state">
            {searchQuery ? 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.' : 'ì €ì¥ëœ íšŒì‚¬ê°€ ì—†ìŠµë‹ˆë‹¤.'}
          </div>
        ) : (
          filteredCompanies.map((company) => {
            const data = companyDataMap.get(company.id);
            return (
              <CompanyCard
                key={company.id}
                company={company}
                score={data?.score}
                sources={data?.sources || []}
                onClick={() => handleOpenDetail(company.id)}
                onDelete={() => handleDelete(company)}
              />
            );
          })
        )}
      </div>
    </div>
  );
}

// íšŒì‚¬ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
interface CompanyCardProps {
  company: Company;
  score?: number;
  sources: string[];
  onClick: () => void;
  onDelete: () => void;
}

function CompanyCard({ company, score, sources, onClick, onDelete }: CompanyCardProps) {
  return (
    <div className="company-card" onClick={onClick}>
      <div className="card-header">
        <h3 className="company-name">{company.name}</h3>
        <div className="score">
          {score !== undefined ? (
            <span className="score-value">â­ {score.toFixed(1)}</span>
          ) : (
            <span className="score-pending">ë¶„ì„ ì „</span>
          )}
        </div>
      </div>

      <div className="source-badges">
        {sources.map((source) => (
          <span key={source} className="badge">
            {source}
          </span>
        ))}
      </div>

      <div className="card-footer">
        <span className="date">
          ìˆ˜ì§‘ì¼: {new Date(company.updatedAt).toLocaleDateString()}
        </span>
        <button
          className="delete-btn"
          onClick={(e) => {
            e.stopPropagation();
            onDelete();
          }}
          title="ì‚­ì œ"
        >
          ğŸ—‘ï¸
        </button>
      </div>
    </div>
  );
}

// ë°ì´í„° íƒ€ì… â†’ ì†ŒìŠ¤ ë ˆì´ë¸”
function getSourceLabel(type: string): string {
  const labels: Record<string, string> = {
    company_info: 'ì›í‹°ë“œ',
    finance_inno: 'í˜ì‹ ì˜ìˆ²',
    finance_dart: 'DART',
    finance_smes: 'ì¤‘ê¸°ë²¤ì²˜',
    review_blind: 'ë¸”ë¼ì¸ë“œ',
    review_jobplanet: 'ì¡í”Œë˜ë‹›',
  };
  return labels[type] || type;
}

// ë Œë”ë§
const root = createRoot(document.getElementById('root')!);
root.render(<ListPage />);
```

### src/pages/list/list.css

```css
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: #f5f5f5;
  color: #333;
  min-height: 100vh;
}

.list-page {
  max-width: 800px;
  margin: 0 auto;
  padding: 24px;
}

.page-header {
  margin-bottom: 24px;
}

.page-header h1 {
  font-size: 24px;
  font-weight: 600;
  margin-bottom: 4px;
}

.subtitle {
  color: #666;
  font-size: 14px;
}

.controls {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
}

.search-box {
  flex: 1;
}

.search-box input {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
}

.sort-box {
  display: flex;
  align-items: center;
  gap: 8px;
}

.sort-box label {
  font-size: 14px;
  color: #666;
}

.sort-box select {
  padding: 10px 12px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
}

.company-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.company-card {
  background: white;
  border-radius: 12px;
  padding: 16px 20px;
  cursor: pointer;
  transition: all 0.2s;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.company-card:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  transform: translateY(-2px);
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.company-name {
  font-size: 18px;
  font-weight: 600;
}

.score-value {
  font-size: 16px;
  font-weight: 500;
  color: #f59e0b;
}

.score-pending {
  font-size: 14px;
  color: #999;
}

.source-badges {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  margin-bottom: 12px;
}

.badge {
  background: #e3f2fd;
  color: #1976d2;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
}

.card-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.date {
  font-size: 13px;
  color: #999;
}

.delete-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 16px;
  padding: 4px;
  opacity: 0.6;
  transition: opacity 0.2s;
}

.delete-btn:hover {
  opacity: 1;
}

.empty-state {
  text-align: center;
  padding: 60px 20px;
  color: #999;
}
```

### src/pages/list/list.html

```html
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>íšŒì‚¬ ëª©ë¡ - AI ê¸°ì—…ë¶„ì„</title>
  <link rel="stylesheet" href="./list.css">
</head>
<body>
  <div id="root"></div>
  <script type="module" src="./ListPage.tsx"></script>
</body>
</html>
```

---

## ì‚°ì¶œë¬¼

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `src/pages/list/ListPage.tsx` | ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ |
| `src/pages/list/list.css` | ìŠ¤íƒ€ì¼ |
| `src/pages/list/list.html` | HTML ì—”íŠ¸ë¦¬ |

---

## ì°¸ì¡° ë¬¸ì„œ
- [spec/05-ui-structure.md](../spec/05-ui-structure.md) - UI êµ¬ì¡° (ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ ì„¹ì…˜)
