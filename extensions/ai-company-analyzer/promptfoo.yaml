# promptfoo.yaml
#
# AI Company Analyzer 프롬프트 테스트 설정
# https://github.com/promptfoo/promptfoo

description: "AI Company Analyzer 프롬프트 테스트"

# 테스트할 프롬프트
prompts:
  - id: text_extraction
    raw: |
      Extract ALL visible text from this image.
      Output only the raw text exactly as shown.
      Do NOT output:
      - JSON or any structured format
      - Chinese characters
      - Repeated text or patterns

      Text:

  - id: classification
    raw: |
      What type of image is this? Reply with ONE word only.

      Categories:
      - company_overview (회사정보)
      - revenue_trend (매출추이)
      - employee_trend (인원추이)
      - balance_sheet (재무제표)
      - review_positive (긍정리뷰)
      - review_negative (부정리뷰)
      - review_mixed (복합리뷰)
      - rating_summary (평점)
      - bar_chart (막대그래프)
      - line_chart (라인차트)
      - table_data (표)
      - unknown

      Answer:

  - id: analysis
    raw: |
      {{instruction}}

      Reply format:
      SCORE: [1-5]
      SUMMARY: [one sentence]
      POINTS: [point1] | [point2] | [point3]

# 테스트용 provider (echo는 입력을 그대로 반환)
providers:
  - id: echo

# 테스트 케이스
tests:
  # ===== 텍스트 추출 테스트 =====
  - description: "텍스트 추출 - JSON 형식 요청 안 함"
    vars:
      prompt: text_extraction
    assert:
      - type: not-contains
        value: "Return JSON"
      - type: not-contains
        value: '{"rawText"'

  - description: "텍스트 추출 - 중국어 지시 없음"
    vars:
      prompt: text_extraction
    assert:
      - type: contains
        value: "Chinese characters"
      - type: contains
        value: "Do NOT"

  # ===== 분류 테스트 =====
  - description: "분류 - ONE word 지시 포함"
    vars:
      prompt: classification
    assert:
      - type: contains
        value: "ONE word only"

  - description: "분류 - 유효한 카테고리 목록 포함"
    vars:
      prompt: classification
    assert:
      - type: contains
        value: "company_overview"
      - type: contains
        value: "revenue_trend"
      - type: contains
        value: "review_positive"

  # ===== 분석 테스트 =====
  - description: "분석 - SCORE 형식 포함"
    vars:
      prompt: analysis
      instruction: "Analyze this image"
    assert:
      - type: contains
        value: "SCORE:"
      - type: contains
        value: "SUMMARY:"
      - type: contains
        value: "POINTS:"

  - description: "분석 - JSON 형식 아님"
    vars:
      prompt: analysis
      instruction: "Test"
    assert:
      - type: not-contains
        value: '{"'
      - type: not-contains
        value: "Return JSON"

# 출력 설정
outputPath: ./promptfoo-results.json
